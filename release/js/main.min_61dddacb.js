var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},__extends=function(t,e){function n(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},__assign=Object.assign||function(t){for(var e,n=1,i=arguments.length;i>n;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},__rest=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n},__decorate=function(t,e,n,i){var r,o=arguments.length,a=3>o?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(3>o?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},__param=function(t,e){return function(n,i){e(n,i,t)}},__metadata=function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},__awaiter=function(t,e,n,i){function r(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(n,o){function a(t){try{l(i.next(t))}catch(e){o(e)}}function s(t){try{l(i["throw"](t))}catch(e){o(e)}}function l(t){t.done?n(t.value):r(t.value).then(a,s)}l((i=i.apply(t,e||[])).next())})},__generator=function(t,e){function n(t){return function(e){return i([t,e])}}function i(n){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(a=2&n[0]?o["return"]:n[0]?o["throw"]||((a=o["return"])&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,o=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){l.label=n[1];break}if(6===n[0]&&l.label<a[1]){l.label=a[1],a=n;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(n);break}a[2]&&l.ops.pop(),l.trys.pop();continue}n=e.call(t,l)}catch(i){n=[6,i],o=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,o,a,s,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},__exportStar=function(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||__createBinding(e,t,n)},__createBinding=Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]},__values=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),a=[];try{for(;(void 0===e||e-->0)&&!(i=o.next()).done;)a.push(i.value)}catch(s){r={error:s}}finally{try{i&&!i.done&&(n=o["return"])&&n.call(o)}finally{if(r)throw r.error}}return a},__spread=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(__read(arguments[e]));return t},__spreadArrays=function(){for(var t=0,e=0,n=arguments.length;n>e;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;n>e;e++)for(var o=arguments[e],a=0,s=o.length;s>a;a++,r++)i[r]=o[a];return i},__await=function(t){return this instanceof __await?(this.v=t,this):new __await(t)},__asyncGenerator=function(t,e,n){function i(t){c[t]&&(u[t]=function(e){return new Promise(function(n,i){h.push([t,e,n,i])>1||r(t,e)})})}function r(t,e){try{o(c[t](e))}catch(n){l(h[0][3],n)}}function o(t){t.value instanceof __await?Promise.resolve(t.value.v).then(a,s):l(h[0][2],t)}function a(t){r("next",t)}function s(t){r("throw",t)}function l(t,e){t(e),h.shift(),h.length&&r(h[0][0],h[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var u,c=n.apply(t,e||[]),h=[];return u={},i("next"),i("throw"),i("return"),u[Symbol.asyncIterator]=function(){return this},u},__asyncDelegator=function(t){function e(e,r){n[e]=t[e]?function(n){return(i=!i)?{value:__await(t[e](n)),done:"return"===e}:r?r(n):n}:r}var n,i;return n={},e("next"),e("throw",function(t){throw t}),e("return"),n[Symbol.iterator]=function(){return this},n},__asyncValues=function(t){function e(e){i[e]=t[e]&&function(i){return new Promise(function(r,o){i=t[e](i),n(r,o,i.done,i.value)})}}function n(t,e,n,i){Promise.resolve(i).then(function(e){t({value:e,done:n})},e)}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),i={},e("next"),e("throw"),e("return"),i[Symbol.asyncIterator]=function(){return this},i)},__makeTemplateObject=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__setModuleDefault=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t["default"]=e},__importStar=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&__createBinding(e,t,n);return __setModuleDefault(e,t),e},__importDefault=function(t){return t&&t.__esModule?t:{"default":t}},__classPrivateFieldGet=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet=function(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n},__reflect=function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n};!function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)e.d(i,r,function(e){return t[e]}.bind(null,r));return i},e.n=function(t){var n=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){n(1),n(2),n(3),n(4),n(0),n(5),n(6),n(7),n(8),n(9),n(10),n(11),n(12),n(13),n(14),n(15),n(16),n(17),n(18),n(19),n(20),n(21),n(22),n(23),n(24),n(25),n(26),n(27),n(28),n(29),n(30),n(31),n(32),n(33),n(34),n(35),n(36),n(37),n(38),n(39),n(40),n(41),n(42),n(43),n(44),n(45),n(46),n(47),n(48),n(49),n(50),n(51),n(52),n(53);var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:return[4,this.loadResource()];case 1:return n.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return t=n.sent(),this.startAnimation(t),[4,platform.login()];case 3:return n.sent(),[4,platform.getUserInfo()];case 4:return e=n.sent(),console.log(e),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,this.loadTheme()];case 2:return n.sent(),[4,RES.loadGroup("preload",0,t)];case 3:return n.sent(),this.stage.removeChild(t),[3,5];case 4:return e=n.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,n){var i=new eui.Theme("resource/default.thm.json",t.stage);i.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){console.log(egret.Capabilities.os),LifecycleCallback.regist();var t=RES.getRes("bgcell2_png"),e=new egret.Bitmap(t);e.fillMode=egret.BitmapFillMode.REPEAT,e.width=this.width,e.height=this.height,e.alpha=.5,this.addChild(e),this.toTitle()},e.prototype.toTitle=function(t){void 0===t&&(t=null);var e=new TitleScene(this.stage);this.stage.addChild(e),e.addEventListener(PlayEvents.START,this.toStage,this),this.currentScene=e},e.prototype.toStage=function(t){void 0===t&&(t=null),this.currentScene&&this.currentScene.dispose();var e=new StageScene(this.stage);this.stage.addChild(e);var n=new Promise(function(t,n){setTimeout(function(){e.startPlay()},1e3)});n["catch"](function(t){return[console.log("stage error : ",t)]}),this.currentScene=e},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},e.prototype.startAnimation=function(t){},e}(eui.UILayer);window.Main=i,__reflect(i.prototype,"Main",[])},function(t,e){var n=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function i(i){e.call(n,i,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?i(r):RES.getResAsync(t,i,this)}else RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)},t}();window.AssetAdapter=n,__reflect(n.prototype,"AssetAdapter",["eui.IAssetAdapter"])},function(t,e){var n=function(){function t(){}return t.BUFF_GAIN="BUFF_GAIN",t.BUFF_LOSE="BUFF_LOSE",t.PLAYER_SHOT="PLAYER_SHOT",t.RECYCLEABLE="RECYCLEABLE",t.DRIFT_MISS="DRIFT_MISS",t.DRIFT_BREAK="DRIFT_BREAK",t.DRIFT_GET="DRIFT_GET",t.START="START",t.RETRY="RETRY",t.CLEAR="CLEAR",t.GAME_OVER="GAME_OVER",t.RANK_UP="RANK_UP",t.OVER_BORDER="OVER_BORDER",t.CLOSE_DESCRIPT="CLOSE_DESCRIPT",t}();window.PlayEvents=n,__reflect(n.prototype,"PlayEvents",[]);var i;!function(t){t[t.ROOKIE=0]="ROOKIE",t[t.NORMAL=1]="NORMAL",t[t.ELITE=2]="ELITE",t[t.EXTREME=3]="EXTREME"}(i||(i={})),window.AIType=i;var r;!function(t){t[t.SLIGHT_AVOID=0]="SLIGHT_AVOID",t[t.AVOID=1]="AVOID",t[t.DASH_AVOID=2]="DASH_AVOID",t[t.TRACE=3]="TRACE",t[t.DASH_TRACE=4]="DASH_TRACE",t[t.GETBUFF=5]="GETBUFF",t[t.SPARE=6]="SPARE",t[t.IMPACT=7]="IMPACT",t[t.BARRAGE=8]="BARRAGE"}(r||(r={})),window.AIActType=r;var o;!function(t){t[t.BULLET_BOOST_BIG=0]="BULLET_BOOST_BIG",t[t.BULLET_BOOST_3DIRECT=1]="BULLET_BOOST_3DIRECT",t[t.BULLET_BOOST_5DIRECT=2]="BULLET_BOOST_5DIRECT",t[t.BULLECT_BOOST_PLUS2DIRECT=3]="BULLECT_BOOST_PLUS2DIRECT",t[t.BARRIER=4]="BARRIER",t[t.SUB_PLANE=5]="SUB_PLANE",t[t.INF_DASH=6]="INF_DASH",t[t.DASH_INVINS=7]="DASH_INVINS"}(o||(o={})),window.BuffType=o;var a=function(){function t(){}return t.LEFT=37,t.UP=38,t.RIGHT=39,t.DOWN=40,t.Z=90,t.X=88,t.C=67,t}();window.Keyboard=a,__reflect(a.prototype,"Keyboard",[])},function(t,e){var n=function(){function t(){}return t.random=function(t,e){return Math.random()*(e-t)+t},t.getMc=function(t,e){void 0===e&&(e=-1);var n=RES.getRes(t+"_json"),i=RES.getRes(t+"_png"),r=new egret.MovieClipDataFactory(n,i),o=new egret.MovieClip(r.generateMovieClipData());return o},t.loadImage=function(t,e,n,i){var r=new egret.ImageLoader;r.crossOrigin="anonymous",r.load(t),r.once(egret.Event.COMPLETE,n,e),r.once(egret.IOErrorEvent.IO_ERROR,i,e)},t.httpReq=function(t,e,n,i,r,o,a,s){"GET"==n&&(t=t+"?"+e);var l=new egret.HttpRequest;l.open(t,n),l.setRequestHeader("Accept","*/*"),s&&l.setRequestHeader("Authorization",s),l.setRequestHeader("Content-Type",a),"GET"==n?l.send():l.send(e),l.addEventListener(egret.Event.COMPLETE,r,i),null!=o&&(l.addEventListener(egret.IOErrorEvent.IO_ERROR,o,i),l.addEventListener(egret.HTTPStatusEvent.CLOSE,o,i))},t.Loaded=function(){window.parent.postMessage({isLoadComplete:!0,url:window.location.href},"*")},t}();window.GlobalMethod=n,__reflect(n.prototype,"GlobalMethod",[])},function(t,e){var n=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);window.LoadingUI=n,__reflect(n.prototype,"LoadingUI",["RES.PromiseTaskReporter"])},function(t,e){var n=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();window.DebugPlatform=n,__reflect(n.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new n)},function(t,e){var n=function(){function t(){}return t.prototype.getTheme=function(t,e,n,i){function r(t){e.call(i,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(i))}var a=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(i,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,n){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(i,generateEUI2)},a)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var s=t.replace(".exml","_EUI.json");generateJSON.paths[t]?egret.callLater(function(){e.call(i,generateJSON.paths[t])},this):RES.getResByUrl(s,function(n){window.JSONParseClass.setData(n),egret.callLater(function(){e.call(i,generateJSON.paths[t])},a)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(i,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT)},t}();window.ThemeAdapter=n,__reflect(n.prototype,"ThemeAdapter",["eui.IThemeAdapter"])},function(t,e){var n=function(){function t(){}return t.GAME_TIME_MINUTES=3,t.ENEMY_DRIFT=!0,t.PLANE_CRASH=!1,t.PLANE_WIDTH=20,t.PLANE_HEIGHT=35,t}();window.WorldData=n,__reflect(n.prototype,"WorldData",[])},function(t,e){var n=function(t){function e(e,n,i){void 0===i&&(i="");var r=t.call(this)||this;return r.type=e,r.duration=n,r.label=i,n>0&&(r.timer=new egret.Timer(r.duration/100,100),r.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,r.delBuff,r)),r}return __extends(e,t),e.prototype.onPause=function(){this.timer&&this.timer.stop()},e.prototype.onResume=function(){this.timer&&this.timer.start()},e.prototype.delBuff=function(t){void 0===t&&(t=null),this.owner.loseBuff(this.type),this.dispatchEvent(new egret.Event(PlayEvents.BUFF_LOSE)),this.timer&&this.timer.reset()},e.prototype.getType=function(){return this.type},e.prototype.startEffect=function(t){this.owner=t,this.timer&&this.timer.start()},e}(egret.EventDispatcher);window.Buff=n,__reflect(n.prototype,"Buff",[])},function(t,e){var n=function(t){function e(e){return void 0===e&&(e=3e3),t.call(this,BuffType.BARRIER,e,"★")||this}return __extends(e,t),e.prototype.startEffect=function(t){this.owner=t,this._barrier=t.barrier,this._barrier.energy=Barrier.MAX_ENERGY,this._barrier.lock(),this.timer&&this.timer.start()},e.prototype.delBuff=function(e){void 0===e&&(e=null),this._barrier.unlock(),t.prototype.delBuff.call(this,e)},e}(Buff);window.BarrierBuff=n,__reflect(n.prototype,"BarrierBuff",[])},function(t,e){var n=function(t){function e(e){return void 0===e&&(e=-1),t.call(this,BuffType.BULLET_BOOST_BIG,e,"B")||this}return __extends(e,t),e.prototype.startEffect=function(t){this.owner=t,t instanceof PlayerPlane?(t.bulletGenerator=BulletLV2.pool,t.bulletRange=BulletLV2.range):(t.bulletGenerator=EnemyBulletLV2.pool,t.bulletRange=EnemyBulletLV2.range)},e.prototype.delBuff=function(e){void 0===e&&(e=null);var n=this.owner;n instanceof PlayerPlane?(n.bulletGenerator=Bullet.pool,n.bulletRange=Bullet.range):(n.bulletGenerator=EnemyBullet.pool,n.bulletRange=EnemyBullet.range),t.prototype.delBuff.call(this,e)},e}(Buff);window.BigBulletBuff=n,__reflect(n.prototype,"BigBulletBuff",[])},function(t,e){var n=function(){function t(t){this._plane=t,this._buffNum=0}return t.getBuffData=function(t){switch(t){case BuffType.BARRIER:return{type:t,defaultDuration:1e4,label:"★"};case BuffType.BULLET_BOOST_BIG:return{type:t,defaultDuration:6e4,label:"B"};case BuffType.BULLECT_BOOST_PLUS2DIRECT:return{type:t,defaultDuration:6e4,label:"+2"};case BuffType.SUB_PLANE:return{type:t,defaultDuration:15e3,label:"S"}}return null},t.prototype.getBuff=function(t,e){var n,i=this;switch(t){case BuffType.BARRIER:i.barrierBuff||i._buffNum++,i.barrierBuff=new BarrierBuff(e),n=i.barrierBuff;break;case BuffType.BULLET_BOOST_BIG:i.bigBulletBuff||i._buffNum++,i.bigBulletBuff=new BigBulletBuff(e),n=i.bigBulletBuff;break;case BuffType.BULLET_BOOST_3DIRECT:i.direction3BulletBuff||i._buffNum++,i.direction3BulletBuff=new Direction3BulletBuff(e),n=i.direction3BulletBuff;break;case BuffType.BULLET_BOOST_5DIRECT:i.direction5BulletBuff||i._buffNum++,i.direction5BulletBuff=new Direction5BulletBuff(e),n=i.direction5BulletBuff;break;case BuffType.BULLECT_BOOST_PLUS2DIRECT:i.directionPlus2BullectBuff||i._buffNum++,i.directionPlus2BullectBuff=new DirectionPlus2BullectBuff(e),n=i.directionPlus2BullectBuff;break;case BuffType.SUB_PLANE:i.subPlaneBuff||i._buffNum++,i.subPlaneBuff=new SubPlaneBuff(e),n=i.subPlaneBuff}n&&(n.startEffect(i._plane),n.addEventListener(PlayEvents.BUFF_LOSE,i.loseBuff,i))},t.prototype.loseBuff=function(t){void 0===t&&(t=null);var e=t.target;switch(e.getType()){case BuffType.BARRIER:this.barrierBuff=null;break;case BuffType.BULLET_BOOST_BIG:this.bigBulletBuff=null;break;case BuffType.BULLET_BOOST_3DIRECT:this.direction3BulletBuff=null;break;case BuffType.BULLET_BOOST_5DIRECT:this.direction5BulletBuff=null;break;case BuffType.BULLECT_BOOST_PLUS2DIRECT:this.directionPlus2BullectBuff=null;break;case BuffType.SUB_PLANE:this.subPlaneBuff=null}this._buffNum--},t.prototype.loseBuff2=function(t){switch(t){case BuffType.BARRIER:this.barrierBuff&&this.barrierBuff.delBuff();break;case BuffType.BULLET_BOOST_BIG:this.bigBulletBuff&&this.bigBulletBuff.delBuff();break;case BuffType.BULLET_BOOST_3DIRECT:this.direction3BulletBuff&&this.direction3BulletBuff.delBuff();break;case BuffType.BULLET_BOOST_5DIRECT:this.direction5BulletBuff&&this.direction5BulletBuff.delBuff();break;case BuffType.BULLECT_BOOST_PLUS2DIRECT:this.directionPlus2BullectBuff&&this.directionPlus2BullectBuff.delBuff();break;case BuffType.SUB_PLANE:this.subPlaneBuff&&this.subPlaneBuff.delBuff()}this._buffNum++},t.prototype.dispose=function(){this.bigBulletBuff&&this.bigBulletBuff.delBuff(),this.dashInvinsibleBuff&&this.dashInvinsibleBuff.delBuff(),this.direction3BulletBuff&&this.direction3BulletBuff.delBuff(),this.direction5BulletBuff&&this.direction5BulletBuff.delBuff(),this.directionPlus2BullectBuff&&this.directionPlus2BullectBuff.delBuff(),this.barrierBuff&&this.barrierBuff.delBuff(),this.subPlaneBuff&&this.subPlaneBuff.delBuff()},t.prototype.onPause=function(){this.bigBulletBuff&&this.bigBulletBuff.onPause(),this.dashInvinsibleBuff&&this.dashInvinsibleBuff.onPause(),this.direction3BulletBuff&&this.direction3BulletBuff.onPause(),this.direction5BulletBuff&&this.direction5BulletBuff.onPause(),this.directionPlus2BullectBuff&&this.directionPlus2BullectBuff.onPause(),this.barrierBuff&&this.barrierBuff.onPause(),this.subPlaneBuff&&this.subPlaneBuff.onPause()},t.prototype.onResume=function(){this.bigBulletBuff&&this.bigBulletBuff.onResume(),this.dashInvinsibleBuff&&this.dashInvinsibleBuff.onResume(),this.direction3BulletBuff&&this.direction3BulletBuff.onResume(),this.direction5BulletBuff&&this.direction5BulletBuff.onResume(),this.directionPlus2BullectBuff&&this.directionPlus2BullectBuff.onResume(),this.barrierBuff&&this.barrierBuff.onResume(),this.subPlaneBuff&&this.subPlaneBuff.onResume()},Object.defineProperty(t.prototype,"buffNum",{get:function(){return this._buffNum},enumerable:!1,configurable:!0}),t}();window.BuffManager=n,__reflect(n.prototype,"BuffManager",[])},function(t,e){var n=function(t){function e(e){return void 0===e&&(e=800),t.call(this,BuffType.DASH_INVINS,e,"")||this}return __extends(e,t),e}(Buff);window.DashInvinsibleBuff=n,__reflect(n.prototype,"DashInvinsibleBuff",[])},function(t,e){var n=function(t){function e(e){return void 0===e&&(e=-1),t.call(this,BuffType.BULLET_BOOST_3DIRECT,e,"+2")||this}return __extends(e,t),e.prototype.startEffect=function(t){this.owner=t,t.bulletDirections=[-45,0,45]},e}(Buff);window.Direction3BulletBuff=n,__reflect(n.prototype,"Direction3BulletBuff",[])},function(t,e){var n=function(t){function e(e){return void 0===e&&(e=-1),t.call(this,BuffType.BULLET_BOOST_5DIRECT,e,"+2")||this}return __extends(e,t),e.prototype.startEffect=function(t){this.owner=t,t.bulletDirections=[-135,-45,0,45,135]},e}(Buff);window.Direction5BulletBuff=n,__reflect(n.prototype,"Direction5BulletBuff",[])},function(t,e){var n=function(t){function e(e){return void 0===e&&(e=-1),t.call(this,BuffType.BULLECT_BOOST_PLUS2DIRECT,e,"+2")||this}return __extends(e,t),e.prototype.startEffect=function(e){t.prototype.startEffect.call(this,e),this.owner=e,1==e.bulletDirections.length?e.bulletDirections=[-45,0,45]:3==e.bulletDirections.length&&(e.bulletDirections=[-135,-45,0,45,135])},e.prototype.delBuff=function(e){void 0===e&&(e=null);var n=this.owner;5==n.bulletDirections.length?n.bulletDirections=[-45,0,45]:3==n.bulletDirections.length&&(n.bulletDirections=[0]),t.prototype.delBuff.call(this,e)},e}(Buff);window.DirectionPlus2BullectBuff=n,__reflect(n.prototype,"DirectionPlus2BullectBuff",[])},function(t,e){var n=function(t){function e(e){return void 0===e&&(e=-1),t.call(this,BuffType.SUB_PLANE,e,"S")||this}return __extends(e,t),e.prototype.startEffect=function(e){t.prototype.startEffect.call(this,e),this.owner=e,this._subA=new SubPlane(e,"LEFT"),this._subB=new SubPlane(e,"RIGHT")},e.prototype.delBuff=function(e){void 0===e&&(e=null),this._subA.dispose(),this._subB.dispose(),t.prototype.delBuff.call(this,e)},e}(Buff);window.SubPlaneBuff=n,__reflect(n.prototype,"SubPlaneBuff",[])},function(t,e){var n=function(){function t(t,e){void 0===e&&(e=0),this.fps=egret.MainContext.instance.stage.frameRate,this.energy=e,this._p=t,this._filter=new egret.GlowFilter(16766720,1,10,10,1e3),this._on=!1}return t.prototype.boot=function(){if(0!=this._energy){var t=this._p;this._on=!0,t.filters?t.filters=t.filters.concat(this._filter):t.filters=[this._filter]}},t.prototype.shut=function(){for(var t=this._p,e=t.filters,n=this._filter,i=0;i<e.length;i++){var r=e[i];if(r==n){e.splice(i);break}}this._on=!1,t.filters=e},Object.defineProperty(t.prototype,"energy",{get:function(){return this._energy},set:function(t){var e=this;t=0>t?0:t,e._energy=t,e._reduceCount=0,0==t&&e._on&&e.shut()},enumerable:!1,configurable:!0}),t.prototype.reduceEnergyByHit=function(t){void 0===t&&(t=5);var e=this;0!=e._energy&&!e._lock&&e._on&&(e.energy-=t)},t.prototype.reduceEnergyByTime=function(){var t=this;0!=t._energy&&!t._lock&&t._on&&(t._reduceCount++,t._reduceCount==t.fps&&t.energy--)},Object.defineProperty(t.prototype,"isOn",{get:function(){return this._on},enumerable:!1,configurable:!0}),t.prototype.lock=function(){this._lock=!0},t.prototype.unlock=function(){this._lock=!1},t.MAX_ENERGY=100,t}();window.Barrier=n,__reflect(n.prototype,"Barrier",[])},function(t,e){var n=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.refreshPosition=function(){this.position=new egret.Point(this.x,this.y)},Object.defineProperty(e.prototype,"isActivated",{get:function(){return null!=this.parent},enumerable:!1,configurable:!0}),e}(egret.Sprite);window.CollisionObject=n,__reflect(n.prototype,"CollisionObject",[])},function(t,e){var n=function(t){function e(){var e=t.call(this)||this;return e.maxHP=1,e._stage=egret.MainContext.instance.stage,e.HP=e.maxHP,e}return __extends(e,t),e.prototype.hit=function(t){return this.HP-=t.planeDamage,!0},e.prototype.isDefeated=function(){return 0==this.HP},e}(CollisionObject);window.BaseCharacter=n,__reflect(n.prototype,"BaseCharacter",[])},function(t,e){var n=function(t){function e(){var e=t.call(this)||this;return e.pWidth=WorldData.PLANE_WIDTH,e.pHeight=WorldData.PLANE_HEIGHT,e.pColor=16777215,e.rotStep=2,e.shotSpeed=200,e.bulletDirections=[0],e.gears=[8,10,15],e.curGear=1,e.MAP_SIZE=StageScene.MAP_SIZE,e.checkOverBorderCount=0,e.maxCheckOverBorderCount=10,e.buffManager=new BuffManager(e),e.shotTimer=new egret.Timer(e.shotSpeed,1),e.moveData=new MoveData,e.barrier=new Barrier(e),e}return __extends(e,t),e.prototype.boot=function(){this.moveData.setData(0,this.speed)},e.prototype.onPause=function(){this.shotTimer.stop(),this.buffManager.onPause()},e.prototype.onResume=function(){this.shotTimer.start(),this.buffManager.onResume()},e.prototype.draw=function(){this.graphics.beginFill(this.pColor),this.graphics.moveTo(-this.pWidth,this.pHeight),this.graphics.lineTo(this.pWidth,this.pHeight),this.graphics.lineTo(0,-this.pHeight),this.graphics.endFill()},e.prototype.move=function(t,e){var n=this;n.rotation+=e*n.rotStep,n.curGear=t+1,n.moveData.setData(n.rotation,n.speed);var i=n.moveData.getDAxis(),r=i.dx,o=i.dy;n.x+=r,n.y+=o,n.checkIfOverBorder()},e.prototype.spin=function(t){var e=this;e.rotation+=t*e.rotStep,e.moveData.setData(e.rotation,e.speed)},e.prototype.shot=function(){var t=this;if(!t.shotTimer.running){for(var e=0;e<t.bulletDirections.length;e++){var n=t.bulletGenerator.getOne();n.x=t.x,n.y=t.y;var i=t.bulletDirections[e];n.setDirection(t.rotation+i),t.parent.addChild(n),n.shoot()}t.shotTimer.start()}},Object.defineProperty(e.prototype,"bulletGenerator",{get:function(){return this._bulletGenerator},set:function(t){this._bulletGenerator=t},enumerable:!1,configurable:!0}),e.prototype.setBuff=function(t,e){this.buffManager.getBuff(t,e)},e.prototype.loseBuff=function(t){},e.prototype.crash=function(){this.buffManager.dispose(),this.parent&&this.parent.removeChild(this)},e.prototype.refreshPosition=function(){t.prototype.refreshPosition.call(this),this._collisionPoints=[new egret.Point(this.x-this.pWidth,this.y),new egret.Point(this.x+this.pWidth,this.y),new egret.Point(this.x,this.y-this.pHeight),new egret.Point(this.x,this.y+this.pHeight)],this.barrier.reduceEnergyByTime()},Object.defineProperty(e.prototype,"collisionPoints",{get:function(){var t=this;return t._collisionPoints.map(function(e,n){return t.parent?t.parent.localToGlobal(e.x,e.y):e})},enumerable:!1,configurable:!0}),e.prototype.collisionCheck=function(t){for(var e=0,n=this.collisionPoints;e<n.length;e++){var i=n[e];if(t.hitTestPoint(i.x,i.y))return!0}return!1},Object.defineProperty(e.prototype,"speed",{get:function(){return this.gears[this.curGear]},enumerable:!1,configurable:!0}),e.prototype.hit=function(t){return this.barrier.isOn?(this.barrier.reduceEnergyByHit(t.barrierDamage),!1):(this.HP-=t.planeDamage,!0)},e.prototype.checkIfOverBorder=function(){var t=this;if(t.checkOverBorderCount<t.maxCheckOverBorderCount)return void t.checkOverBorderCount++;t.checkOverBorderCount=0;var e="";if(t.x<=0?e="left":t.x>=t.MAP_SIZE?e="right":t.y<=0?e="top":t.y>=t.MAP_SIZE&&(e="bottom"),0!=e.length){var n=new egret.Event(PlayEvents.OVER_BORDER);n.data={d:e},t.dispatchEvent(n)}},e.prototype.bootBarrier=function(t){t?this.barrier.boot():this.barrier.shut()},Object.defineProperty(e.prototype,"isBarrier",{get:function(){return this.barrier.isOn},enumerable:!1,configurable:!0}),e}(BaseCharacter);window.BasePlane=n,__reflect(n.prototype,"BasePlane",[])},function(t,e){var n=function(){function t(t){this._arr=[],this._func=t}return t.prototype.getOne=function(){for(var t=null,e=0,n=this._arr;e<n.length;e++){var i=n[e];if(!i.activate){t=i;break}}return t||(t=this._func(),this._arr.push(t)),t.activate=!0,t},t.prototype.recycle=function(t){void 0===t&&(t=null);var e=t.target;e.activate=!1},t.prototype.dispose=function(){this._arr=null,this._func=null},t}();window.Pool=n,__reflect(n.prototype,"Pool",[])},function(t,e){var n=function(t){function e(n,i,r,o,a){void 0===n&&(n=10),void 0===i&&(i=16775885),void 0===r&&(r=0),void 0===o&&(o=40),void 0===a&&(a=e.range);var s=t.call(this)||this;return s._stage=egret.MainContext.instance.stage,s.activate=!1,s.size=n,s.color=i,s.distance=a,s.curDis=0,s.draw(),s.loadPartical(),s.moveData=new MoveData,s.moveData.setData(r,o),s._planeDamage=1,s._barrierDamage=10,s}return __extends(e,t),e.prototype.setDirection=function(t,e){void 0===t&&(t=0),void 0===e&&(e=-1),-1==e&&(e=this.moveData.speed),this.moveData.setData(t,e)},e.prototype.shoot=function(){var t=this;t.activate=!0,t._sp.visible=!0,t.curDis=0,t._blastBmp&&(t._blastBmp.visible=!1),t._blastPartical&&(t._blastPartical.visible=!1)},e.prototype.onFly=function(t){void 0===t&&(t=null);var e=this,n=e.moveData.getDAxis(),i=n.dx,r=n.dy;e.x+=i,e.y+=r,e.curDis+=e.moveData.speed,e.curDis>=e.distance&&e.disposeImmediately()},e.prototype.dispose=function(t){var e=this;void 0===t&&(t=!0),t&&this.blast(),setTimeout(function(){e.activate=!1,e.parent&&e.parent.removeChild(e)},200)},e.prototype.disposeImmediately=function(){this.activate=!1,this.parent&&this.parent.removeChild(this)},e.prototype.draw=function(){var t=new egret.Sprite;t.graphics.beginFill(this.color),t.graphics.drawCircle(0,0,this.size),t.graphics.endFill(),t.x=-this.size/2,t.y=-this.size/2,this.addChild(t),this._sp=t,this._sp.visible=!0},e.prototype.drawBlast=function(){var t=new egret.Bitmap;t.texture=RES.getRes("sheet_json#bulletblast"),t.width=4*this.size,t.height=4*this.size,t.x=2*-this.size,t.y=2*-this.size,this.addChild(t),this._blastBmp=t,this._blastBmp.visible=!1},e.prototype.loadPartical=function(){this._blastPartical=new particle.GravityParticleSystem(RES.getRes("blast_png"),RES.getRes("blast_json")),this.addChild(this._blastPartical)},e.prototype.blast=function(){this._sp.visible=!1,this._blastBmp&&(this._blastBmp.visible=!0),this._blastPartical&&(this._blastPartical.visible=!0,this._blastPartical.start())},e.prototype.refreshPosition=function(){t.prototype.refreshPosition.call(this),this._collisionPoints=[new egret.Point(this.x,this.y)]},Object.defineProperty(e.prototype,"collisionPoints",{get:function(){var t=this;return t._collisionPoints.map(function(e,n){return t.parent?t.parent.localToGlobal(e.x,e.y):e})},enumerable:!1,configurable:!0}),e.prototype.collisionCheck=function(t){for(var e=0,n=this.collisionPoints;e<n.length;e++){var i=n[e];if(t.hitTestPoint(i.x,i.y))return!0}return!1},Object.defineProperty(e.prototype,"planeDamage",{get:function(){return this._planeDamage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"barrierDamage",{get:function(){return this._barrierDamage},enumerable:!1,configurable:!0}),e.range=2e3,e.pool=new Pool(function(){var t=new e;return e.allArr.push(t),t}),e.allArr=[],e}(CollisionObject);window.Bullet=n,__reflect(n.prototype,"Bullet",["IPoolObject"])
},function(t,e){var n=function(t){function e(){var n=t.call(this,15,16766720,0,40,e.range)||this;return n._barrierDamage=20,n}return __extends(e,t),e.prototype.draw=function(){var t=new egret.Bitmap;t.texture=RES.getRes("sheet_json#bullet"),t.width=2*this.size,t.height=2*this.size,t.x=-this.size,t.y=-this.size,this.addChild(t),this._sp=t},e.prototype.refreshPosition=function(){this.position=new egret.Point(this.x,this.y),this._collisionPoints=[new egret.Point(this.x,this.y-this.width),new egret.Point(this.x-this.width,this.y),new egret.Point(this.x+this.width,this.y)]},Object.defineProperty(e.prototype,"collisionPoints",{get:function(){var t=this;return t._collisionPoints.map(function(e,n){return t.parent?t.parent.localToGlobal(e.x,e.y):e})},enumerable:!1,configurable:!0}),e.range=3e3,e.pool=new Pool(function(){var t=new e;return Bullet.allArr.push(t),t}),e}(Bullet);window.BulletLV2=n,__reflect(n.prototype,"BulletLV2",[]);var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.pool=new Pool(function(){var t=new e;return EnemyBullet.allArr.push(t),t}),e}(n);window.EnemyBulletLV2=i,__reflect(i.prototype,"EnemyBulletLV2",[])},function(t,e){var n=function(t){function e(){var e=t.call(this)||this;return e._arr=[],e}return __extends(e,t),e.prototype.setDashTime=function(t){if(t>this._arr.length)for(var e=this._arr.length;t>e;e++){var n=this.drawIcon();n.x=-n.width*(e+1),this.addChild(n),this._arr.push(n)}for(var e=0;e<this._arr.length;e++)this._arr[e].visible=t>e},e.prototype.drawIcon=function(){var t=new egret.Bitmap,e=RES.getRes("sheet_json#jet");return t.texture=e,t.width*=.5,t.height*=.5,t},e}(egret.Sprite);window.DashGauge=n,__reflect(n.prototype,"DashGauge",[])},function(t,e){var n=function(t){function e(e){void 0===e&&(e=30);var n=t.call(this)||this;return n.buff=null,n.maxHP=3,n.HP=3,n._time=e,n.draw(),n}return __extends(e,t),e.prototype.timePassed=function(){return this._time--,0!=this._time},e.prototype.draw=function(){var t=new egret.Bitmap;t.texture=RES.getRes("sheet_json#drift"),t.width=80,t.height=80,t.x=0,t.y=0,this.addChild(t)},e.prototype.change2Buff=function(t){if(void 0===t&&(t=null),!t){var e=[BuffType.BULLET_BOOST_BIG];t=e[Math.floor(Math.random()*e.length)]}var n=BuffManager.getBuffData(t);this.buff=n,this.drawBuff()},e.prototype.drawBuff=function(){if(this.buff){var t=new egret.Bitmap;t.texture=RES.getRes("sheet_json#buff"),t.width=100,t.height=100,t.x=0,t.y=0;var e=new egret.TextField;e.bold=!0,e.size=80,e.textColor=0,e.width=100,e.height=100,e.verticalAlign=egret.VerticalAlign.MIDDLE,e.textAlign=egret.HorizontalAlign.CENTER,e.text=this.buff.label,this.removeChildren(),this.addChild(t),this.addChild(e)}},e.prototype.dispose=function(){this.parent&&this.parent.removeChild(this)},e.prototype.refreshPosition=function(){this.position=new egret.Point(this.x,this.y),this._collisionPoints=[new egret.Point(this.x,this.y),new egret.Point(this.x+this.width,this.y),new egret.Point(this.x+this.width,this.y+this.height),new egret.Point(this.x,this.y+this.height)]},Object.defineProperty(e.prototype,"collisionPoints",{get:function(){var t=this;return t._collisionPoints.map(function(e,n){return t.parent?t.parent.localToGlobal(e.x,e.y):e})},enumerable:!1,configurable:!0}),e.prototype.collisionCheck=function(t){for(var e=0,n=this.collisionPoints;e<n.length;e++){var i=n[e];if(t.hitTestPoint(i.x,i.y))return!0}return!1},e}(BaseCharacter);window.Drift=n,__reflect(n.prototype,"Drift",[])},function(t,e){var n=function(t){function e(e,n,i){void 0===e&&(e=3),void 0===n&&(n=5),void 0===i&&(i=180);var r=t.call(this)||this;return r._movePoint=null,r._dx=0,r._dy=0,r.maxHP=5,r.HP=5,r.pWidth=e,r.pHeight=n,r.draw(),r.pColor=16711680,r.gears=[4,10,16],r.shotSpeed=750,r.shotTimer.delay=r.shotSpeed,r.bulletGenerator=EnemyBullet.pool,r.bulletRange=EnemyBullet.range,r._rotationDirection=0,r._score=100,r.rotation=i,r}return __extends(e,t),e.prototype.boot=function(){this.moveData.setData(this.rotation,this.speed),this.aiCfg=new AIConfig(this)},e.prototype.shot=function(){this.shotTimer.running||(this.shotTimer.repeatCount=0,this.shotTimer.addEventListener(egret.TimerEvent.TIMER,this.onShot,this),this.shotTimer.start())},e.prototype.stop=function(){this.shotTimer.running&&(this.shotTimer.removeEventListener(egret.TimerEvent.TIMER,this.onShot,this),this.shotTimer.stop())},e.prototype.onShot=function(){var t=this;if(t.parent)for(var e=t.parent,n=0;n<t.bulletDirections.length;n++){var i=t.bulletGenerator.getOne();i.x=t.x,i.y=t.y;var r=t.bulletDirections[n];i.setDirection(t.rotation+r),e.addGameObj(i),i.shoot()}},e.prototype.draw=function(){var t=this,e=new PlaneDisp(1);e.width=4*t.pWidth,e.height=4*t.pHeight,e.x=2*-t.pWidth,e.y=2*-t.pHeight,t.addChild(e),t._disp=e},e.prototype.refreshMove=function(){var t=this;t.rotation+=t._rotationDirection*t.rotStep,t.curGear=1,t.moveData.setData(t.rotation,t.speed);var e=t.moveData.getDAxis(),n=e.dx,i=e.dy;this.x+=n,this.y+=i,this.checkIfOverBorder()},e.prototype.refreshAI=function(t,e){var n=this,i=n.aiCfg.refreshAI(t,e);if(i){var r="";switch(i.shot==AI_Shot.FIRE?(r+="开始射击,",n.shot()):(r+="停止射击,",n.stop()),i.speed){case AI_Speed.NORMAL:r+="平速,",n.curGear=1;break;case AI_Speed.FAST:r+="加速,",n.curGear=2;break;case AI_Speed.SLOW:r+="减速,",n.curGear=0}switch(i.rotation){case AI_Rotation.MINUS:r+="逆时针,",n._rotationDirection=-1;break;case AI_Rotation.STRAIGHT:r+="直线,",n._rotationDirection=0;break;case AI_Rotation.PLUS:r+="顺时针,",n._rotationDirection=1}}},e.prototype.crash=function(){this.stop(),t.prototype.crash.call(this)},e.prototype.getDirectionFromMovePoint=function(){this._movePoint&&(this._movePoint.x>this.x+this.speed?this._dx=1:this._movePoint.x<this.x-this.speed?this._dx=-1:this._dx=0,this._movePoint.y>this.y+this.speed?this._dy=1:this._movePoint.y<this.y-this.speed?this._dy=-1:this._dy=0)},e.prototype.checkShouldShot=function(){this._playerPosition&&(this._playerPosition.x>this.x-2*this.width&&this._playerPosition.x<this.x+2*this.width?this._shouldShot=!0:this._shouldShot=!1)},e.prototype.getLessBulletDirection=function(){var t=this.x>this._stage.stageWidth-this.x?-1:1,e=this.y>this._stage.stageHeight-this.y?-1:1;return[t,e]},Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!1,configurable:!0}),e}(BasePlane);window.EnemyPlane=n,__reflect(n.prototype,"EnemyPlane",[])},function(t,e){var n=function(t){function e(e,n,i){void 0===e&&(e=30),void 0===n&&(n=50),void 0===i&&(i=180);var r=t.call(this,e,n,i)||this;return r.maxHP=8,r.HP=8,r.gears=[8,14,20],r.shotSpeed=550,r.shotTimer.delay=r.shotSpeed,r._score=300,r}return __extends(e,t),e.prototype.checkShouldShot=function(){this._shouldShot=!0},e}(EnemyPlane);window.EliteEnemyPlane=n,__reflect(n.prototype,"EliteEnemyPlane",[])},function(t,e){var n=function(t){function e(){return t.call(this,12,13047173,0,25,e.range)||this}return __extends(e,t),e.range=2e3,e.pool=new Pool(function(){var t=new e;return e.allArr.push(t),t}),e.allArr=[],e}(Bullet);window.EnemyBullet=n,__reflect(n.prototype,"EnemyBullet",[])},function(t,e){var n=function(t){function e(e,n,i){void 0===e&&(e=30),void 0===n&&(n=50),void 0===i&&(i=180);var r=t.call(this,e,n,i)||this;return r.maxHP=10,r.HP=10,r.gears=[2,18,28],r.shotSpeed=350,r.shotTimer.delay=r.shotSpeed,r._score=1e3,r}return __extends(e,t),e.prototype.boot=function(){t.prototype.boot.call(this),this.aiCfg.driftFirst=WorldData.ENEMY_DRIFT},e.prototype.checkShouldShot=function(){this._shouldShot=!0},e.prototype.draw=function(){var t=this,e=new PlaneDisp(2);e.width=4*t.pWidth,e.height=4*t.pHeight,e.x=2*-t.pWidth,e.y=2*-t.pHeight,t.addChild(e),t._disp=e},e.prototype.setBuff=function(e,n){t.prototype.setBuff.call(this,e,n),this.buffManager.buffNum>=1&&(this.aiCfg.driftFirst=!1)},e.prototype.loseBuff=function(e){t.prototype.loseBuff.call(this,e),this.buffManager.buffNum<=0&&(this.aiCfg.driftFirst=!0)},e}(EnemyPlane);window.ExtremeEnemyPlane=n,__reflect(n.prototype,"ExtremeEnemyPlane",[])},function(t,e){var n=function(t){function e(e,n){void 0===e&&(e=3),void 0===n&&(n=5);var i=t.call(this)||this;return i.maxHP=5,i.HP=5,i.pWidth=e,i.pHeight=n,i.pColor=65280,i.draw(),i.barrier.energy=100,i.bulletDirections=[0],i.bulletGenerator=Bullet.pool,i.bulletRange=Bullet.range,i}return __extends(e,t),e.prototype.draw=function(){var t=this,e=new PlaneDisp(0);e.width=4*t.pWidth,e.height=4*t.pHeight,e.x=2*-t.pWidth,e.y=2*-t.pHeight,t.addChild(e),t._disp=e},e.prototype.move=function(e,n){t.prototype.move.call(this,e,n),this._disp.setSpinState(n)},e.prototype.crash=function(){t.prototype.crash.call(this),this.dispatchEvent(new egret.Event(PlayEvents.GAME_OVER))},e.prototype.shot=function(){this.shotTimer.running||(t.prototype.shot.call(this),this.dispatchEvent(new egret.Event(PlayEvents.PLAYER_SHOT)))},e}(BasePlane);window.PlayerPlane=n,__reflect(n.prototype,"PlayerPlane",[])},function(t,e){var n=function(t){function e(e,n,i,r){void 0===i&&(i=20),void 0===r&&(r=30);var o=t.call(this)||this;return o.followDelay=200,o.pWidth=i,o.pHeight=r,o.pColor=2263842,o.draw(),o._mainPlane=e,o._place=n,"LEFT"==n?o._offsetX=-e.width/2-o.width-50:o._offsetX=e.width/2+o.width+50,o._offsetY=e.height/2-o.height/2,o.x=e.x+o._offsetX,o.y=e.y+o._offsetY,e.parent.addChild(o),e.addEventListener(PlayEvents.PLAYER_SHOT,o.shot,o),o.bulletGenerator=e.bulletGenerator,o.move(),o}return __extends(e,t),e.prototype.draw=function(){var t=new egret.Bitmap;t.texture=RES.getRes("sheet_json#plane2"),t.width=4*this.pWidth,t.height=4*this.pHeight,t.x=2*-this.pWidth,t.y=2*-this.pHeight,this.addChild(t)},e.prototype.dispose=function(){this._moveTween&&(this._moveTween.pause(),this._moveTween=null),this._mainPlane.removeEventListener(PlayEvents.PLAYER_SHOT,this.shot,this),this.removeChildren(),this.parent&&this.parent.removeChild(this)},e.prototype.move=function(){var t=this,e=t._mainPlane.x+t._offsetX,n=t._mainPlane.y+t._offsetY;if(t.rotation=t._mainPlane.rotation,e==t.x&&n==t.y)t._moveTween=egret.Tween.get(t).wait(200).call(t.move,t,[0,0]);else{var i={x:e,y:n};t._moveTween=egret.Tween.get(t).to(i,200).call(t.move,t,[0,0])}},e.prototype.shot=function(){var t=this,e=t.bulletGenerator.getOne();e.x=t.x,e.y=t.y,e.setDirection(t.rotation),t.parent.addChild(e),e.shoot()},e}(BasePlane);window.SubPlane=n,__reflect(n.prototype,"SubPlane",[])},function(t,e){var n=function(t){function e(e){var n=t.call(this)||this;return n._curAnalogX=0,n._curAnalogY=0,n._stageAnalogX=0,n._stageAnalogY=0,n.skinName="resource/eui_skins/ControlPanel.exml",n.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.initData,n),n._stage=e,n}return __extends(e,t),e.prototype.initData=function(t){var e=this;e.width=e._stage.stageWidth,e.btn_shot.x=e.width-e.btn_shot.width,e.btn_barrier.x=e.btn_shot.x,e.btn_shot.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onPressShot,e),e.btn_shot.addEventListener(egret.TouchEvent.TOUCH_END,e.onReleaseShot,e),e.btn_shot.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,e.onReleaseShot,e),e.analog.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onPressAnalog,e),e.analog.addEventListener(egret.TouchEvent.TOUCH_MOVE,e.onPressAnalog,e),e.analog.addEventListener(egret.TouchEvent.TOUCH_END,e.onReleaseAnalog,e),e.analog.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,e.onReleaseAnalog,e),e._stageAnalogX=e.analog.x+e.x,e._stageAnalogY=e.analog.y+e.y,e.barrier_gauge.x=e.btn_barrier.x,e.barrier_gauge.width=e.btn_barrier.width,e.btn_barrier.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onPressBarrier,e)},e.prototype.onPressShot=function(t){this.onKeyDown&&this.onKeyDown({keyCode:Keyboard.Z})},e.prototype.onReleaseShot=function(t){this.onKeyUp&&this.onKeyUp({keyCode:Keyboard.Z})},e.prototype.onPressBarrier=function(t){this.onKeyDown&&this.onKeyDown({keyCode:Keyboard.X})},e.prototype.onPressAnalog=function(t){var e=0,n=0;switch(t.target.name){case"leftup":e=-1,n=1;break;case"up":e=0,n=1;break;case"rightup":e=1,n=1;break;case"left":e=-1,n=0;break;case"right":e=1,n=0;break;case"leftdown":e=-1,n=-1;break;case"down":e=0,n=-1;break;case"rightdown":e=1,n=-1;break;default:return}(e!=this._curAnalogX||n!=this._curAnalogY)&&(this._curAnalogX=e,this._curAnalogY=n,this.onDirectChange(e,n))},e.prototype.onReleaseAnalog=function(t){this._curAnalogX=0,this._curAnalogY=0,this.onDirectChange&&this.onDirectChange(this._curAnalogX,this._curAnalogY)},e}(eui.Component);window.ControlPanel=n,__reflect(n.prototype,"ControlPanel",[])},function(t,e){var n=function(){function t(){var t=this;this._spinDirect=0,this._lineSpd=0,this._lock=!0,this._shotTriggered=!1,document.addEventListener("keydown",function(e){t.onKeyDown(e)}),document.addEventListener("keyup",function(e){t.onKeyUp(e)})}return t.getInstance=function(){return t.ins||(t.ins=new t),t.ins},t.prototype.setPanel=function(t){var e=this;t.onDirectChange=function(t,n){e.setDirect(t,n)},t.onKeyDown=function(t){e.onKeyDown(t)},t.onKeyUp=function(t){e.onKeyUp(t)},this._panel=t},t.prototype.setDirect=function(t,e){this._spinDirect=t,this._lineSpd=e},t.prototype.setControllee=function(t){this._controllee=t},t.prototype.setLock=function(t){this._lock=t},t.prototype.btnTrigger=function(t){void 0===t&&(t=null);var e=this;e._controllee.move(e._lineSpd,e._spinDirect),e._shotTriggered&&e._controllee.shot()},t.prototype.onKeyDown=function(t){if(!this._lock)switch(t.keyCode){case Keyboard.Z:this._shotTriggered=!0;break;case Keyboard.X:this._controllee.bootBarrier(!this._controllee.isBarrier);break;case Keyboard.C:break;case Keyboard.LEFT:this._spinDirect=-1;break;case Keyboard.UP:this._lineSpd=1;break;case Keyboard.RIGHT:this._spinDirect=1;break;case Keyboard.DOWN:this._lineSpd=-1}},t.prototype.onKeyUp=function(t){switch(t.keyCode){case Keyboard.Z:this._shotTriggered=!1;break;case Keyboard.X:break;case Keyboard.C:break;case Keyboard.LEFT:this._spinDirect=0;break;case Keyboard.UP:this._lineSpd=0;break;case Keyboard.RIGHT:this._spinDirect=0;break;case Keyboard.DOWN:this._lineSpd=0}},t}();window.Controller=n,__reflect(n.prototype,"Controller",["IController"])},function(t,e){},function(t,e){var n=function(t){function e(e,n,i){var r=t.call(this)||this;r._stage=egret.MainContext.instance.stage,r.graphics.lineStyle(50,16711680,.6),r.graphics.beginFill(65280),r.graphics.drawRect(0,0,e,e),r.graphics.endFill();var o=RES.getRes("bgcell2_png"),a=new egret.Bitmap(o);a.fillMode=egret.BitmapFillMode.REPEAT,a.width=e,a.height=e;var s=new egret.Sprite;s.width=e,s.height=e,s.addChild(a),r._layer=s,r.anchorOffsetX=e/2,r.anchorOffsetY=e/2,r.x=n/2,r.y=i/2,r._oriPos=new egret.Point(r.x,r.y),t.prototype.addChild.call(r,s);var l=RES.getRes("clouds_png"),u=new egret.Bitmap(l);return u.fillMode=egret.BitmapFillMode.REPEAT,u.width=e,u.height=e,u.alpha=.8,t.prototype.addChild.call(r,u),r._clouds=u,r}return __extends(e,t),e.prototype.resetPosition=function(){this.x=this._oriPos.x,this.y=this._oriPos.y},e.prototype.setPosition=function(t,e){var n=this;n.x=t,n.y=e},Object.defineProperty(e.prototype,"layerRotation",{get:function(){return this._layer.rotation},set:function(t){this._layer.rotation=t},enumerable:!1,configurable:!0}),e.prototype.addGameObj=function(e){t.prototype.addChildAt.call(this,e,this.numChildren-1)},e.prototype.addChild=function(t){return this._layer.addChild(t)},e}(egret.Sprite);window.BgLayer=n,__reflect(n.prototype,"BgLayer",[])},function(t,e){var n=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!0,e.touchChildren=!0,e.skinName="resource/eui_skins/Description.exml",e.btn_next.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onNext,e),e._curPage=0,e}return __extends(e,t),e.prototype.dispose=function(){this.btn_next.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onNext,this)},e.prototype.onNext=function(t){return 4==this._curPage?void this.dispatchEvent(new egret.Event(PlayEvents.CLOSE_DESCRIPT)):void(this.currentState="p"+ ++this._curPage)},e}(eui.Component);window.DescriptionPage=n,__reflect(n.prototype,"DescriptionPage",[])},function(t,e){var n=function(t){function e(e){var n=t.call(this)||this;return n.x=0,n.y=0,n.width=e.stageWidth,n.height=e.stageHeight,n.graphics.beginFill(8900331),n.graphics.drawRect(0,0,n.width,n.height),n.graphics.endFill(),n.display(),n}return __extends(e,t),e.prototype.display=function(){var t=new PlayerPlane;t.x=t.width/2,t.y=t.height/2;var e=new EnemyPlane;e.x=e.width/2,e.y=e.height/2,this.addChild(e)},e}(egret.Sprite);window.DisplayScene=n,__reflect(n.prototype,"DisplayScene",[])},function(t,e){var n=function(t){function e(e,n,i,r,o,a){void 0===a&&(a=null);var s=t.call(this)||this;return s.skinName="resource/eui_skins/GameResult.exml",s.addEventListener(eui.UIEvent.CREATION_COMPLETE,s.initData,s),s._clear=e,s._time=n,s._bullet=i,s._hit=r,s._defeat=o,s._callBack=a,s}return __extends(e,t),e.prototype.initData=function(){var t=this;t.txt_hit.text=t._hit+"次",t.txt_bullet.text=t._bullet+"颗",t.txt_defeat.text=t._defeat+"分";var e=t._time,n=Math.floor(e/60);if(0==n)t.txt_time.text=e+"秒";else{var i=e%60;t.txt_time.text=n+"分 "+i+"秒"}t.btn_retry.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onClick,t)},e.prototype.dispose=function(){this.btn_retry.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.parent&&this.parent.removeChild(this)},e.prototype.onClick=function(t){this._callBack?this._callBack(t):this.dispatchEvent(new egret.Event(PlayEvents.CLEAR))},e}(eui.Component);window.GameResult=n,__reflect(n.prototype,"GameResult",[])},function(t,e){var n=function(t){function e(n){var i=t.call(this)||this;i._stage=egret.MainContext.instance.stage,i._buffRate=.5,i._collisionCheckInterval=0,i.width=i._stage.stageWidth,i.height=i._stage.stageHeight,i._bgLayer=new BgLayer(e.MAP_SIZE,i.width,i.height),i._bgLayer.addEventListener(PlayEvents.OVER_BORDER,i.onOverBorder,i);var r=i.width/2,o=i.height/2,a=new egret.Sprite;return a.width=i.width,a.height=i.height,a.anchorOffsetX=r,a.anchorOffsetY=o,a.x=r,a.y=o,a.addChild(i._bgLayer),i._playArea=a,i.addChild(a),i.mapSizeData={halfMapSize:e.MAP_SIZE/2,halfStageWidth:r,halfStageHeight:o},LifecycleCallback.addFunc("stage",function(){i.pause()},function(){i.resume()}),i}return __extends(e,t),e.prototype.startPlay=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=this,t._playerBullet=0,t._playerHit=0,t._defeatEnemy=0,t._score=0,t._rank=0,t._enemy=[],t._drifts=[],t.initRadar(),[4,t.initPlayer()];case 1:return e.sent(),[4,t.createEnemy()];case 2:return e.sent(),t.createDrift(),t.initUI(),t.onRankUp(null),t.addEventListener(egret.Event.ENTER_FRAME,t.refreshStage,t),t.startEnemyTimer(),[2]}})})},e.prototype.initUI=function(){var t=this;if(egret.Capabilities.os.indexOf("Windows")<0){var e=new ControlPanel(t._stage);e.y=t._stage.stageHeight-e.height,t.addChild(e),t._controlPanel=e,t._playerController.setPanel(e),t._barrierGauge=e.barrier_gauge}else{var n=new BarrierGauge;n.width=.4*t.width,n.height=50,n.x=.3*t.width,n.y=t.height-100,t.addChild(n),t._barrierGauge=n}t._barrierGauge.plane=t._player,t._barrierGauge.refresh();var i=t._timelimit?t._timelimit:new TimeLimit;i.second=60*WorldData.GAME_TIME_MINUTES,i.width=t.width,i.y=20,i.once(PlayEvents.GAME_OVER,t.GameOver,t),i.addEventListener(PlayEvents.RANK_UP,t.onRankUp,t),t.addChild(i),t._timelimit=i},e.prototype.initRadar=function(){var t=new Radar(200,10);this.addChild(t),this._radar=t},e.prototype.initPlayer=function(){var t=this,e=this.mapSizeData.halfMapSize,n=new PlayerPlane(WorldData.PLANE_WIDTH,WorldData.PLANE_HEIGHT),i=Controller.getInstance();return i.setControllee(n),this._player=n,this._playerController=i,n.x=e,n.y=e+this.mapSizeData.halfStageHeight,n.boot(),this._bgLayer.addGameObj(n),n.addEventListener(PlayEvents.PLAYER_SHOT,function(e){t._playerBullet++},this),n.addEventListener(PlayEvents.OVER_BORDER,this.onOverBorder,this),new Promise(function(r,o){egret.Tween.get(n).to({y:e},1e3).call(function(){n.refreshPosition(),i.setLock(!1),t._radar.regPlayer(n)}).call(r,t)})},e.prototype.startEnemyTimer=function(){this._enemyTimer=new egret.Timer(1e4),this._enemyTimer.addEventListener(egret.TimerEvent.TIMER,this.onEnemyTimer,this),this._enemyTimer.start()},e.prototype.onEnemyTimer=function(){var t=this;t._enemy.length<4&&t.createEnemy()},e.prototype.createEnemy=function(){var t,n=this,i=e.MAP_SIZE,r=Math.floor(4*Math.random()),o=0,a=0,s=0,l=WorldData.PLANE_WIDTH,u=WorldData.PLANE_HEIGHT,c={};switch(r){case 0:o=Math.random()*i*.8+.1*i,a=-u,s=180,c={y:100};break;case 1:o=Math.random()*i*.8+.1*i,a=i+u,s=0,c={y:i-100-u};break;case 2:o=-u,a=Math.random()*i*.8+.1*i,s=90,c={x:100};break;case 3:o=i+u,a=Math.random()*i*.8+.1*i,s=270,c={x:i-100-u}}c={};var h=Math.round(Math.random()*this._rank);return t=2>h?new EnemyPlane(l,u,s):3>h?new EliteEnemyPlane(l,u,s):new ExtremeEnemyPlane(l,u,s),t.x=o,t.y=a,t.addEventListener(PlayEvents.OVER_BORDER,this.onOverBorder,this),this._bgLayer.addGameObj(t),t.boot(),new Promise(function(e,i){egret.Tween.get(t).to(c,1e3).call(function(){t.refreshPosition(),n._enemy.push(t),n._radar.regObject(t)},n).call(e,n)})},e.prototype.createDrift=function(){this._driftTimer=new egret.Timer(5e3),this._driftTimer.addEventListener(egret.TimerEvent.TIMER,this.onDriftTimer,this),this._driftTimer.start()},e.prototype.onDriftTimer=function(t){var n=this;if(n._driftTimer.currentCount%10==0&&!(Math.random()<n._buffRate||n._drifts.length>=2)){var i=new Drift,r=.2*e.MAP_SIZE,o=3*r;i.x=Math.random()*o+r,i.y=Math.random()*o+r,i.refreshPosition(),n._radar.regObject(i),n._bgLayer.addChild(i),n._drifts.push(i)}},e.prototype.refreshStage=function(t){var e=this;if(e._playerController.btnTrigger(),e.refreshAllPosition(),e.refreshCamera(),e._radar.refresh(),e._barrierGauge.refresh(),e._timelimit.refresh(),3!=e._collisionCheckInterval)return void e._collisionCheckInterval++;if(e._collisionCheckInterval=0,WorldData.PLANE_CRASH)for(var n=0,i=this._enemy;n<i.length;n++){var r=i[n];if(this._player.collisionCheck(r))return this._player.crash(),void this.GameOver()}for(var o=0,a=Bullet.allArr;o<a.length;o++){var s=a[o];if(s.activate){for(var l=!1,u=0;u<e._enemy.length;u++){var c=e._enemy[u];if(s.collisionCheck(c)){console.log("enemy hit.");var h=c.hit(s);SoundManager.instance().playBgs("hit_mp3"),s.dispose(h),l=!0,c.isDefeated()&&(SoundManager.instance().playBgs("explode_mp3"),c.crash(),c.removeEventListener(PlayEvents.OVER_BORDER,e.onOverBorder,e),e._score+=c.score,e._radar.removeObject(c),e._enemy.splice(u,1),e._defeatEnemy++);break}}for(var u=0;u<e._drifts.length;u++){var f=e._drifts[u];s.collisionCheck(f)&&!l&&(s.dispose(),f.hit(s),SoundManager.instance().playBgs("hit_mp3"),f.isDefeated()&&f.change2Buff())}}}for(var p=0,d=EnemyBullet.allArr;p<d.length;p++){var s=d[p];if(s.activate){var l=!1;if(s.collisionCheck(this._player)){console.log("player hit");var h=this._player.hit(s);if(SoundManager.instance().playBgs("hit_mp3"),l=!0,s.dispose(h),h||this._playerHit++,this._player.isDefeated())return SoundManager.instance().playBgs("explode_mp3"),this._player.crash(),void this.GameOver();break}if(!l)for(var u=0;u<e._drifts.length;u++){var f=e._drifts[u];s.collisionCheck(f)&&!l&&(s.dispose(),f.hit(s),f.isDefeated()&&f.change2Buff())}}}for(var _=0;_<e._drifts.length;){var f=e._drifts[_];if(f.buff){var g=!1;if(f.collisionCheck(e._player)&&(e._player.setBuff(f.buff.type,f.buff.defaultDuration),g=!0),!g&&WorldData.ENEMY_DRIFT)for(var y=0,v=this._enemy;y<v.length;y++){var m=v[y];if(f.collisionCheck(m)){m.setBuff(f.buff.type,f.buff.defaultDuration),g=!0;break}}g?(f.dispose(),e._radar.removeObject(f),e._drifts.splice(_,1)):_++}else _++}},e.prototype.refreshAllPosition=function(){var t=this;t._player.refreshPosition();for(var e=0,n=t._enemy;e<n.length;e++){var i=n[e],r=i;r.refreshPosition(),r.refreshAI(t._player,t._drifts),r.refreshMove()}for(var o=0,a=Bullet.allArr;o<a.length;o++){var s=a[o];s.activate&&(s.onFly(),s.refreshPosition())}for(var l=0,u=EnemyBullet.allArr;l<u.length;l++){var s=u[l];s.activate&&(s.onFly(),s.refreshPosition())}},e.prototype.refreshCamera=function(){var t=this,e=t._player,n=t._bgLayer,i=e.x-t.mapSizeData.halfMapSize,r=e.y-t.mapSizeData.halfMapSize,o=e.rotation;n.setPosition(t.mapSizeData.halfStageWidth-i,t.mapSizeData.halfStageHeight-r),t._playArea.rotation=-o},e.prototype.onOverBorder=function(t){var n=this,i=t.currentTarget,r=n._bgLayer,o=i.x,a=i.y;switch(t.data.d){case"top":a=e.MAP_SIZE-i.y-i.height;break;case"bottom":a=e.MAP_SIZE-i.y+i.height;break;case"left":o=e.MAP_SIZE-i.x-i.width;break;case"right":o=e.MAP_SIZE-i.x+i.width}if(i.x=o,i.y=a,i==n._player){var s=n._player,l=s.x-n.mapSizeData.halfMapSize,u=s.y-n.mapSizeData.halfMapSize;s.rotation;r.setPosition(n.mapSizeData.halfStageWidth-l,n.mapSizeData.halfStageHeight-u)}},e.prototype.addChild=function(e){return e instanceof Bullet?this._bgLayer.addChild(e):t.prototype.addChild.call(this,e)},e.prototype.GameOver=function(t){var e=this;void 0===t&&(t=null),console.log("game over."),this.cleanStage();var n=new GameResult(!1,this._timelimit.usedTime,this._playerBullet,this._playerHit,this._score,function(t){n.dispose(),e.startPlay()});n.x=(this._stage.stageWidth-n.width)/2,n.y=100,this.parent.addChild(n)},e.prototype.onRankUp=function(t){if(3!=this._rank){this._rank++;var e="";switch(this._rank){case 1:e="normal_mp3";break;case 2:e="elite_mp3";break;case 3:e="extreme_mp3"}e.length>0&&SoundManager.instance().play(e)}},e.prototype.cleanStage=function(){var t=this;try{t._bgLayer.resetPosition(),t._playArea.rotation=0,t.removeEventListener(egret.Event.ENTER_FRAME,t.refreshStage,t),t._player.crash(),t._player=null;for(var e=0,n=t._enemy;e<n.length;e++){var i=n[e];i.crash()}t._enemy=[],t._driftTimer.stop(),t._driftTimer.removeEventListener(egret.TimerEvent.TIMER,t.onDriftTimer,t),t._driftTimer=null,t._enemyTimer.stop(),t._enemyTimer.removeEventListener(egret.TimerEvent.TIMER,t.onEnemyTimer,t),t._enemyTimer=null,t._drifts.forEach(function(t,e){t.dispose()}),t._drifts=null,t._radar.dispose(),t._controlPanel&&t.removeChild(t._controlPanel);for(var r=0,o=Bullet.allArr;r<o.length;r++){var a=o[r];a.disposeImmediately()}for(var s=0,l=EnemyBullet.allArr;s<l.length;s++){var a=l[s];a.disposeImmediately()}}catch(i){console.log(i)}},e.prototype.pause=function(){var t=this;t.removeEventListener(egret.Event.ENTER_FRAME,t.refreshStage,t),t._driftTimer.stop(),t._enemyTimer.stop()},e.prototype.resume=function(){var t=this;t.addEventListener(egret.Event.ENTER_FRAME,t.refreshStage,t),t._driftTimer.start(),t._enemyTimer.start()},e.prototype.dispose=function(){this.cleanStage(),LifecycleCallback.removeFunc("stage")},e.MAP_SIZE=5e3,e}(egret.Sprite);window.StageScene=n,__reflect(n.prototype,"StageScene",[])},function(t,e){var n=function(t){function e(e){var n=t.call(this)||this;n._stage=egret.MainContext.instance.stage,n.x=0,n.y=0,n.width=n._stage.stageWidth,n.height=n._stage.stageHeight;var i=new eui.Component;i.skinName="resource/eui_skins/Title.exml",i.width=n.width,i.y=50,n.addChild(i);var r=n.createBtn("开始游戏");r.x=(n.width-r.width)/2,r.y=n.height-350,n.addChild(r),r.addEventListener(egret.TouchEvent.TOUCH_TAP,n.gameStart,n),n._startBtn=r;var o=n.createBtn("游戏说明");return o.x=(n.width-o.width)/2,o.y=n.height-150,o.addEventListener(egret.TouchEvent.TOUCH_TAP,n.openDescript,n),n.addChild(o),n._desBtn=o,SoundManager.instance().play("title_mp3"),n}return __extends(e,t),e.prototype.gameStart=function(t){this.dispatchEvent(new egret.Event(PlayEvents.START))},e.prototype.openDescript=function(t){var e=this;e._descript=new DescriptionPage,e._descript.x=(e._stage.stageWidth-e._descript.width)/2,e._descript.y=e._stage.stageHeight-e._descript.height-100,e.addChild(e._descript),e._descript.once(PlayEvents.CLOSE_DESCRIPT,e.closeDescript,e),e._startBtn.visible=!1,e._desBtn.visible=!1},e.prototype.closeDescript=function(t){var e=this;e._descript&&(e._descript.parent.removeChild(e._descript),e._descript=null,e._startBtn.visible=!0,e._desBtn.visible=!0)},e.prototype.createBtn=function(t,e){void 0===e&&(e=50);var n=new eui.Button;return n.skinName="resource/eui_skins/ButtonSkin.exml",n.label=t,n.width=300,n.height=100,n.labelDisplay.size=e,n},e.prototype.dispose=function(){this.removeChildren(),this.parent.removeChild(this)},e}(egret.Sprite);window.TitleScene=n,__reflect(n.prototype,"TitleScene",[])},function(t,e){var n=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"plane",{set:function(t){this._plane=t,this.refresh()},enumerable:!1,configurable:!0}),e.prototype.refresh=function(){this.value=this._plane?this._plane.barrier.energy:0},e}(eui.ProgressBar);window.BarrierGauge=n,__reflect(n.prototype,"BarrierGauge",[])},function(t,e){var n=function(){function t(){this.data={deg:void 0,rad:void 0,spd:void 0,sin:void 0,cos:void 0},this._dx=0,this._dy=0}return Object.defineProperty(t.prototype,"speed",{get:function(){return this.data.spd},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sin",{get:function(){return this.data.sin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cos",{get:function(){return this.data.cos},enumerable:!1,configurable:!0}),t.prototype.setData=function(t,e){var n=this.data;if(n.deg!=t||n.spd!=e){if(n.deg!=t){var i=t*Math.PI/180,r=Math.sin(i),o=Math.cos(i);n=__assign(__assign({},n),{deg:t,rad:i,sin:r,cos:o})}this._dx=e*n.sin,this._dy=e*n.cos,n=__assign(__assign({},n),{spd:e}),this.data=n}},t.prototype.getDAxis=function(){return{dx:this._dx,dy:-this._dy}},t}();window.MoveData=n,__reflect(n.prototype,"MoveData",[])},function(t,e){var n=function(t){function e(e){var n=t.call(this)||this;switch(e){case 0:n.skinName="resource/eui_skins/playerPlane.exml";break;case 1:n.skinName="resource/eui_skins/enemyPlane.exml";break;case 2:n.skinName="resource/eui_skins/extremeplane.exml"}return n}return __extends(e,t),e.prototype.setSpinState=function(t){if(t!=this.curSpin)switch(this.curSpin=t,t){case-1:this.currentState="lspin";break;case 0:this.currentState="normal";break;case 1:this.currentState="rspin"}},e}(eui.Component);window.PlaneDisp=n,__reflect(n.prototype,"PlaneDisp",[])},function(t,e){var n=function(t){function e(e,n,i,r){void 0===i&&(i=75),void 0===r&&(r=3e3);var o=t.call(this)||this;o.RADAR_OBJ_R=10;var a=2*i;return o.x=e-a,o.y=n,o.width=a,o.height=a,o._r=i,o._distance=r,o._objs=[],o._radarObjs=[],o.draw(),o}return __extends(e,t),e.prototype.dispose=function(){this._radarObjs=null,this._objs=null,this.parent&&this.parent.removeChild(this)},e.prototype.draw=function(){var t=new egret.Bitmap(RES.getRes("sheet_json#radar"));t.width=this.width,t.height=this.height,this.addChild(t);var e=new egret.Sprite;e.width=this.width,e.height=this.height,e.x=e.width/2,e.y=e.height/2,e.anchorOffsetX=e.x,e.anchorOffsetY=e.y,this._layer=e,this.addChild(e)},e.prototype.regPlayer=function(t){this._player=t},e.prototype.regObject=function(t){var e=this;if(e._objs){var n;t instanceof BasePlane?n=e.drawEnemey():t instanceof Drift&&(n=e.drawDrift()),e._objs.push(t),e._radarObjs.push(n),e.calc(e._player,t,n),e._layer.addChild(n)}},e.prototype.removeObject=function(t){var e=this;this._objs.every(function(n,i){if(n==t){e._objs.splice(i,1);var r=e._radarObjs.splice(i,1)[0];return r.parent&&r.parent.removeChild(r),!1}return!0})},e.prototype.refresh=function(){var t=this;t._objs;t._objs.forEach(function(e,n){t.calc(t._player,e,t._radarObjs[n])}),t._layer.rotation=-t._player.rotation},e.prototype.calc=function(t,e,n){if(!t||!e)return-1;var i=this._r,r=this.RADAR_OBJ_R/2,o=t.position,a=e.position,s=egret.Point.distance(o,a);if(s>this._distance)return n.visible=!1,-1;var l=(a.x-o.x)/s,u=(a.y-o.y)/s,c=l*i,h=u*i;return n.x=i+c+r,n.y=i+h+r,n.visible=!0,1},e.prototype.drawEnemey=function(){var t=this.RADAR_OBJ_R,e=new egret.Shape;return e.graphics.beginFill(16729344),e.graphics.drawCircle(-t,-t,t),e.graphics.endFill(),e.cacheAsBitmap=!0,e},e.prototype.drawDrift=function(){var t=this.RADAR_OBJ_R,e=new egret.Shape;return e.graphics.beginFill(16766720),e.graphics.drawCircle(-t,-t,t),e.graphics.endFill(),e.cacheAsBitmap=!0,e
},e}(egret.Sprite);window.Radar=n,__reflect(n.prototype,"Radar",[])},function(t,e){var n=function(t){function e(){var e=t.call(this)||this;return e._curSec=0,e._totSec=0,e._count=0,e.skinName="resource/eui_skins/TimeLimit.exml",e._fps=egret.MainContext.instance.stage.frameRate,e}return __extends(e,t),Object.defineProperty(e.prototype,"usedTime",{get:function(){return this._totSec-this._curSec},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"second",{set:function(t){this._totSec=t,this._curSec=t,this._count=0,this.refreshText()},enumerable:!1,configurable:!0}),e.prototype.refresh=function(){var t=this;return t._count++,t._count<t._fps?void 0:(t._count=0,t._curSec--,t.refreshText(),0==t._curSec?void t.dispatchEvent(new egret.Event(PlayEvents.GAME_OVER)):void(t._curSec%60==0&&t.dispatchEvent(new egret.Event(PlayEvents.RANK_UP))))},e.prototype.refreshText=function(){var t=this,e=Math.floor(t._curSec/60),n=t._curSec%60;t.txt&&(t.txt.text=e+":"+(10>n?"0"+n:n))},e}(eui.Component);window.TimeLimit=n,__reflect(n.prototype,"TimeLimit",[])},function(t,e){var n=function(){function t(t){var e=this;this.plane=t,this.positionData={},this.driftFirst=!1,this.startShotAngle=10,this.aicfg={shot:i.CEASE,rotation:r.STRAIGHT,speed:o.NORMAL};var n=egret.MainContext.instance.stage.frameRate;this.fps=n,this.counters=[function(){return 5*n},function(){return e.phrase2Counter},function(){return 3}],this.phraseTime=[-1,10*n,10*n],this.phrase=0,this.timeCounter=0}return t.prototype.refreshAI=function(t,e){var n=this,i={nextAct:!1,nextPhrase:!1};switch(n.positionData.tgt&&n.positionData.tgt.isActivated||n.targetCalc(t,e),n.phrase){case 0:n.timeCounter--,n.timeCounter<=0&&(n.driftFirst&&n.targetCalc(t,e),n.resetTimeCounter(),i=n.p0Test(),console.log("刷新移动策略 ： ",n.positionData.tgt,n.aicfg));break;case 1:if(n.phraseTimeCounter--,n.phraseTimeCounter<=0)return console.log("移动阶段结束"),n.resetAI(),n.phrase=0,n.aicfg;n.timeCounter--,n.timeCounter<=0&&(n.resetTimeCounter(),i=n.p1Test());break;case 2:return n.phraseTimeCounter--,n.phraseTimeCounter<=0?(console.log("追击阶段结束"),n.resetAI(),i.nextPhrase=!0):(n.timeCounter--,n.timeCounter<=0&&(n.resetTimeCounter(),i=n.p2Test())),i.nextPhrase&&(console.log(n.aicfg),n.phrase=n.phrase==n.counters.length-1?0:n.phrase+1),n.aicfg}return i.nextPhrase?(n.phrase=n.phrase==n.counters.length?0:n.phrase+1,n.aicfg):i.nextAct?n.aicfg:null},t.prototype.p0Test=function(){var t=this,e=t.aicfg,n=e.shot,i=e.rotation,r=e.speed;switch(t.distanceCalc(),t.enemyRotationCalc(),t.angleCalc(),t.pr1DirectionCalc(),t.pr2LineCalc(),t.pr3SideCalc(),t.positionData.pr1){case a.SAME:switch(t.positionData.pr2){case s.BEHIND:r=o.FAST,i=t.getRotationSide(t.positionData.pr3,"out");break;case s.FRONT:r=o.NORMAL,i=t.getRotationSide(t.positionData.pr3,"in")}break;case a.DIFF:switch(t.positionData.pr2){case s.BEHIND:r=o.FAST,i=t.getRotationSide(t.positionData.pr3,"out");break;case s.FRONT:r=o.SLOW,i=t.getRotationSide(t.positionData.pr3,"in")}}return t.aicfg={shot:n,rotation:i,speed:r},{nextPhrase:!0,nextAct:!0}},t.prototype.p1Test=function(){var t=this,e=!1,n=t.aicfg,i=n.shot,o=n.rotation,a=n.speed;return t.distanceCalc(),t.enemyRotationCalc(),t.pr2LineCalc(),t.angleCalc(),t.positionData.angle<=45&&t.positionData.pr2==s.FRONT&&(t.positionData.distance<=t.plane.bulletRange?(t.pr3SideCalc(),o=t.getRotationSide(t.positionData.pr3,"in"),t.aicfg={shot:i,rotation:o,speed:a},e=!0):t.aicfg={shot:i,rotation:r.STRAIGHT,speed:a}),{nextPhrase:e,nextAct:!0}},t.prototype.p2Test=function(){var t=this,e=t.aicfg,n=e.shot,a=e.rotation,l=e.speed,u=!1,c=function(){n=i.CEASE,a=r.STRAIGHT,l=o.NORMAL};if(t.enemyRotationCalc(),!u){t.distanceCalc();var h=t.positionData.distance,f=t.plane.bulletRange;h>2*f?(console.log("距离过远结束追击"),c(),u=!0):l=h>f?o.FAST:o.NORMAL}return u||(t.pr2LineCalc(),t.positionData.pr2!=s.FRONT&&(console.log("机位超过目标结束追击"),c(),u=!0)),u||(t.angleCalc(),t.positionData.angle>45?(console.log("目标超出射程角度范围结束追击"),c(),u=!0):t.positionData.angle<=t.startShotAngle?(n=i.FIRE,a=r.STRAIGHT):n=i.CEASE),u||(t.pr3SideCalc(),a=t.getRotationSide(t.positionData.pr3,"in")),t.aicfg={shot:n,speed:l,rotation:a},{nextPhrase:u,nextAct:!0}},t.prototype.targetCalc=function(t,e){var n=this.plane,i=egret.Point.distance(t.position,n.position),r=t;if(this.driftFirst)for(var o=0,a=e;o<a.length;o++){var s=a[o],l=egret.Point.distance(s.position,n.position);i=l,r=s}this.positionData=__assign(__assign({},this.positionData),{distance:i,tgt:r})},t.prototype.distanceCalc=function(){var t=this.plane,e=this.positionData.tgt,n=egret.Point.distance(t.position,e.position);this.positionData=__assign(__assign({},this.positionData),{distance:n})},t.prototype.pr1DirectionCalc=function(){var t=(this.plane,this.positionData.tgt),e=this.positionData.enemyRotation,n=t.rotation<0?t.rotation+360:t.rotation,i=Math.abs(n-e);i=i>180?Math.abs(i-360):i;var r=90>=i,o=r?a.SAME:a.DIFF;this.positionData=__assign(__assign({},this.positionData),{pr1:o,playerRotation:n})},t.prototype.pr2LineCalc=function(){var t,e=this.plane,n=this.positionData.tgt,i=this.positionData.enemyRotation,r=Math.tan(i*Math.PI/180),o=e.y-r*e.x,a=r*n.x+o;t=90>i||i>270?n.y<a?s.FRONT:s.BEHIND:n.y>a?s.FRONT:s.BEHIND,this.positionData=__assign(__assign({},this.positionData),{pr2:t})},t.prototype.pr3SideCalc=function(){var t,e=this.plane,n=this.positionData.tgt,i=this.positionData.enemyRotation,r=-1/Math.tan(i*Math.PI/180),o=e.y-r*e.x,a=r*n.x+o;t=this.positionData.angle<5?l.STRAIGHT:i>=0&&180>i?n.y<a?l.LEFT:l.RIGHT:n.y>a?l.LEFT:l.RIGHT,this.positionData=__assign(__assign({},this.positionData),{pr3:t,k:r,b:o})},t.prototype.angleCalc=function(){var t=this.plane,e=this.positionData.tgt,n=this.positionData.enemyRotation,i=Math.tan(n*Math.PI/180),r=(e.y-t.y)/(e.x-t.x),o=Math.abs((i-r)/(1+i*r)),a=180*Math.atan(o)/Math.PI,s=90-a;this.positionData=__assign(__assign({},this.positionData),{angle:s})},t.prototype.enemyRotationCalc=function(){var t=this.plane,e=t.rotation<0?t.rotation+360:t.rotation;Math.abs(t.rotation)%90==0&&e++,this.positionData=__assign(__assign({},this.positionData),{enemyRotation:e})},t.prototype.getRotationSide=function(t,e){if(t==l.STRAIGHT)return r.STRAIGHT;if("out"==e){if(t==l.LEFT)return r.PLUS;if(t==l.RIGHT)return r.MINUS}else if("in"==e){if(t==l.LEFT)return r.MINUS;if(t==l.RIGHT)return r.PLUS}},Object.defineProperty(t.prototype,"phrase",{get:function(){return this._phrase},set:function(t){this._phrase=t,this.timeCounter=this.counters[t](),this.phraseTimeCounter=this.phraseTime[t]},enumerable:!1,configurable:!0}),t.prototype.resetTimeCounter=function(){this.timeCounter=this.counters[this._phrase]()},Object.defineProperty(t.prototype,"phrase2Counter",{get:function(){var t=this;return t.positionData.pr2==s.FRONT&&t.positionData.angle<=90?3:this.fps},enumerable:!1,configurable:!0}),t.prototype.resetAI=function(){this.aicfg={shot:i.CEASE,rotation:r.STRAIGHT,speed:o.NORMAL}},t}();window.AIConfig=n,__reflect(n.prototype,"AIConfig",[]);var i;!function(t){t[t.FIRE=0]="FIRE",t[t.CEASE=1]="CEASE"}(i||(i={})),window.AI_Shot=i;var r;!function(t){t[t.PLUS=0]="PLUS",t[t.STRAIGHT=1]="STRAIGHT",t[t.MINUS=2]="MINUS"}(r||(r={})),window.AI_Rotation=r;var o;!function(t){t[t.FAST=0]="FAST",t[t.NORMAL=1]="NORMAL",t[t.SLOW=2]="SLOW"}(o||(o={})),window.AI_Speed=o;var a;!function(t){t[t.SAME=0]="SAME",t[t.DIFF=1]="DIFF"}(a||(a={})),window.PosRelat_Direction=a;var s;!function(t){t[t.FRONT=0]="FRONT",t[t.BEHIND=1]="BEHIND"}(s||(s={})),window.PosRelat_LINE=s;var l;!function(t){t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT",t[t.STRAIGHT=2]="STRAIGHT"}(l||(l={})),window.PosRelat_SIDE=l},function(t,e){var n,n=window.CollisionUtils;!function(t){function e(t,e,n){var i=n.length;if(3>i)return!1;var r=0,o=[];for(r=0;r<n.length;r++){var a=new egret.Point(n[r].x,n[r].y);o.push(a)}for(r=0;r<o.length;r++)o[r].x+=e.x,o[r].y+=e.y;if(this.vectorCrossPoint(o[0],t,o[1])>0)return!1;if(this.vectorCrossPoint(o[0],t,o[i-1])<0)return!1;r=2;for(var s=i-1,l=-1;s>=r;){var u=r+s>>1;this.vectorCrossPoint(o[0],t,o[u])>0?(l=u,s=u-1):r=u+1}return 0>l?!1:this.vectorCrossPoint(o[l-1],t,o[l])<0}function n(t,e,n){return(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)}t.checkPointCollideShape=e,t.vectorCrossPoint=n}(n||(n={})),window.CollisionUtils=n},function(t,e){var n=function(){function t(){}return t}();window.Dialog=n,__reflect(n.prototype,"Dialog",[])},function(t,e){var n=function(){function t(){}return t.regist=function(){egret.lifecycle.onPause=this.onPause,egret.lifecycle.onResume=this.onResume},t.addFunc=function(e,n,r){t.map[e]=new i(n,r)},t.removeFunc=function(e){delete t.map[e]},t.onPause=function(){for(var e in t.map)t.map[e].onPause()},t.onResume=function(){for(var e in t.map)t.map[e].onResume()},t.map={},t}();window.LifecycleCallback=n,__reflect(n.prototype,"LifecycleCallback",[]);var i=function(){function t(t,e){this.onPause=t,this.onResume=e}return t}();window.LcyObj=i,__reflect(i.prototype,"LcyObj",[])},function(t,e){var n=function(){function t(){this.HTTP_URL="https://xxxx"}return t.prototype.dataFormat=function(t){if(t){var e=[];for(var n in t)e.push(n+"="+t[n]);return e.join("&")}return""},t.prototype.getToken=function(){return sessionStorage.getItem("token")},t.prototype.requestGetImg=function(t,e){var n=this;return new Promise(function(i,r){var o=new egret.HttpRequest;n.dataFormat(e);o.responseType=egret.HttpResponseType.TEXT,o.open(t,egret.HttpMethod.GET),o.send(),o.addEventListener(egret.Event.COMPLETE,function(t){i()},n),o.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){r(t)},n)})},t.prototype.requestGet=function(t,e){var n=this;return new Promise(function(i,r){var o=new egret.HttpRequest,a=n.dataFormat(__assign(__assign({},e),{ucode:n.getToken()}));o.responseType=egret.HttpResponseType.TEXT,o.open(n.HTTP_URL+t+"?"+a,egret.HttpMethod.GET),o.send(),o.addEventListener(egret.Event.COMPLETE,function(t){var e=t.currentTarget;i(JSON.parse(e.response))},n)})},t.prototype.requestPost=function(t,e){var n=this;return new Promise(function(i,r){var o=new egret.HttpRequest,a=n.dataFormat(__assign(__assign({},e),{ucode:n.getToken()}));o.responseType=egret.HttpResponseType.TEXT,o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.open(n.HTTP_URL+t,egret.HttpMethod.POST),o.send(a),o.addEventListener(egret.Event.COMPLETE,function(t){var e=t.currentTarget;e.response?i(JSON.parse(e.response)):(console.log("系统出错，请稍后再试"),r(t))},n),o.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){console.log("服务器连接失败，请稍后再试")},n)})},t}();window.RequestUtil=n,__reflect(n.prototype,"RequestUtil",[])},function(t,e){var n=function(){function t(){}return t.Debug=!1,t.env="pro",t}();window.Setting=n,__reflect(n.prototype,"Setting",[])},function(t,e){var n=function(){function t(){var t=this;LifecycleCallback.addFunc("bgm",function(){t.pause()},function(){t.resume()}),this._bgs={},this._defaultVolume=.5}return t.prototype.play=function(t,e){void 0===e&&(e=!0),this._bgm&&this._bgmChannel.stop(),this._bgm=RES.getRes(t),this._bgm.type=egret.Sound.MUSIC;try{if(this._isPausing)return;this._bgmChannel=this._bgm.play(0,e?0:1),this._bgmChannel.volume=this._defaultVolume}catch(n){console.error(n)}},t.prototype.playBgs=function(t){var e;e=this._bgs[t]?this._bgs[t]:RES.getRes(t),e&&e.play(0,1)},t.prototype.resume=function(){this._isPausing=!1,this._bgm&&this._bgmChannel&&(this._bgmChannel=this._bgm.play(this._bgmPosition,1),this._bgmChannel.volume=this._defaultVolume,this._bgmChannel.addEventListener(egret.Event.SOUND_COMPLETE,this.onResumeOver,this))},t.prototype.onResumeOver=function(t){this._bgm&&this._bgmChannel&&(this._bgmChannel=this._bgm.play(0,0),this._bgmChannel.volume=this._defaultVolume)},t.prototype.pause=function(){this._isPausing=!0,this._bgm&&this._bgmChannel&&(this._bgmPosition=this._bgmChannel.position,this._bgmChannel.stop())},t.prototype.stop=function(){this._bgm&&this._bgmChannel&&(this._bgmChannel.stop(),this._bgmChannel=null,this._bgm=null)},t.instance=function(){return t._ins||(t._ins=new t),t._ins},t}();window.SoundManager=n,__reflect(n.prototype,"SoundManager",[])},function(t,e){var n=function(){function t(t){this.p=t,console.log(t)}return t.print=function(t){Setting.Debug&&console.log(t)},t.addArmature=function(t,e){var n,i,r=RES.getRes(t.ske),o=RES.getRes(t.tex),a=RES.getRes(t.png),s=new dragonBones.EgretFactory,l=s.parseDragonBonesData(r);s.addDragonBonesData(l),s.addTextureAtlasData(s.parseTextureAtlasData(o,a)),n=s.buildArmature(l.armatureNames[0]),i=n.display,s.clock.add(n),e(n,i),egret.Ticker.getInstance().register(function(t){s.clock.advanceTime(1e-4)},this)},t.onTicker=function(t){this._time||(this._time=t);var e=t,n=e-this._time;return this._time=e,dragonBones.WorldClock.clock.advanceTime(n/1e3),!1},t.RoundRect=function(t,e,n){void 0===n&&(n=10);var i=new egret.Shape;i.graphics.beginFill(2631720),i.graphics.drawRoundRect(0,0,t.width,t.height,n,n),i.graphics.endFill(),i.y=t.x,i.x=t.y,e.addChild(i),t.mask=i},t.pressBtn=function(t,e){t.addEventListener(egret.TouchEvent.TOUCH_END,function(){e&&e()},this)},t.touchBtn=function(t,e,n){t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){egret.Tween.get(t).to({scaleX:.8,scaleY:.8},80,egret.Ease.cubicIn).call(function(){n&&n()})},this),t.addEventListener(egret.TouchEvent.TOUCH_END,function(){egret.Tween.get(t).to({scaleX:1,scaleY:1},100,egret.Ease.cubicIn).call(function(){egret.Tween.removeTweens(t),e&&e()})},this),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){egret.Tween.get(t).to({scaleX:1,scaleY:1},100,egret.Ease.cubicIn).call(function(){egret.Tween.removeTweens(t),e&&e()})})},t.itemTap=function(t,e){t.addEventListener(eui.ItemTapEvent.ITEM_TAP,function(n){var i=-1!=t.selectedIndex?t.selectedIndex:null,r=t.$indexToRenderer[i].$children[0];egret.Tween.get(r).to({scaleX:.9,scaleY:.9},80).to({scaleX:1,scaleY:1},50).call(function(){e&&e(t.selectedItem,i),egret.Tween.removeTweens(r)})},this)},t.ListChildClick=function(e,n,i){var r=e.$indexToRenderer;r.forEach(function(e,r){var o=e.$children[0],a=o.$children[n];t.touchBtn(a,function(){i(o,r)})})},t.dargMove=function(t,e,n,i,r,o,a){function s(t){if(h)if(2==d){if(2==c.names.length){c[t.touchPointID].x=t.stageX,c[t.touchPointID].y=t.stageY;var n=l();a&&a(n/p,_)}}else e.x=t.stageX-f.x,e.y=t.stageY-f.y,_.x=e.x,_.y=e.y,r&&r(function(t){h=t,(h=!1)&&(c={names:[]},d=0)})}function l(){var t=0,e=c.names;return t=egret.Point.distance(c[e[e.length-1]],c[e[e.length-2]])}var u=this;void 0===n&&(n=!1);var c={names:[]},h=!1,f=new egret.Point,p=0,d=0,_={x:e.x,y:e.y};e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(r){null==c[r.touchPointID]&&1==n&&(c[r.touchPointID]=new egret.Point(r.stageX,r.stageY),c.names.push(r.touchPointID)),h=!0,d++,2==d?p=l():(f.x=r.stageX-e.x,f.y=r.stageY-e.y,i&&i(f)),t.addEventListener(egret.TouchEvent.TOUCH_MOVE,s,u)},this),e.addEventListener(egret.TouchEvent.TOUCH_END,function(e){h=!1,c={names:[]},d=0,o&&o(),t.removeEventListener(egret.TouchEvent.TOUCH_MOVE,s,u)},this)},t.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e.texture},t.deepCopyObj=function(t){var e=Array.isArray(t)?[]:{};for(var n in t)t.hasOwnProperty(n)&&("object"==typeof t[n]&&null!==t[n]?e[n]=this.deepCopyObj(t[n]):e[n]=t[n]);return e},t.getUrlParam=function(t,e){var n=new RegExp("(\\?|&)"+t+"=([^&#]*)"),i=n.exec(e?e:location.href);return null!=i?decodeURIComponent(i[2]):null},t}();window.Tool=n,__reflect(n.prototype,"Tool",[])}]);